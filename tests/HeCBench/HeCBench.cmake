# Set source directory for HeCBench benchmarks
set(HECBENCH_SOURCE_DIR ${CMAKE_SOURCE_DIR}/HeCBench)

#find_program(HIPCC_PATH hipcc HINTS "${CMAKE_BINARY_DIR}/bin")
#if(NOT HIPCC_PATH)
#    message(FATAL_ERROR "hipcc not found. Please ensure it is built and accessible.")
#endif()

# Define a custom target group for building all HeCBench tests
add_custom_target(include_hecbench)

# Function to add a benchmark for build and test
function(add_hecbench name path_suffix)
  # Set the benchmark directory path
  set(BENCHMARK_DIR "${HECBENCH_SOURCE_DIR}/${path_suffix}")

  # Define the test name using the desired format
  set(TEST_NAME "${name}_hip")

  # Add a custom target for building the benchmark using its Makefile
  add_custom_target(${TEST_NAME} ALL
    COMMAND ${CMAKE_COMMAND} -E echo "Building ${TEST_NAME} using its Makefile"
    COMMAND ${CMAKE_COMMAND} -E chdir ${BENCHMARK_DIR} make
    WORKING_DIRECTORY ${BENCHMARK_DIR}
  )

  # Register a CTest to run the benchmark using its 'make run' rule
  add_test(NAME ${TEST_NAME}
    COMMAND ${CMAKE_COMMAND} -E chdir ${BENCHMARK_DIR} make run
  )

  # Add the benchmark target to the hecbench_targets group
  add_dependencies(include_hecbench ${TEST_NAME})
endfunction()

# Add benchmarks using add_hecbench with exact names
if (CHIP_BUILD_HECBENCH)
    add_hecbench(accuracy accuracy-hip)
    add_hecbench(ace ace-hip)
    add_hecbench(adam adam-hip)
    add_hecbench(addBiasResidualLayerNorm addBiasResidualLayerNorm-hip)
    add_hecbench(adv adv-hip)
    add_hecbench(aes aes-hip)
    add_hecbench(affine affine-hip)
    add_hecbench(aidw aidw-hip)
    add_hecbench(aligned-types aligned-types-hip)
    add_hecbench(all-pairs-distance all-pairs-distance-hip)
    add_hecbench(amgmk amgmk-hip)
    add_hecbench(ans ans-hip)
    add_hecbench(aobench aobench-hip)
    add_hecbench(aop aop-hip)
    add_hecbench(asmooth asmooth-hip)
    add_hecbench(assert assert-hip)
    add_hecbench(asta asta-hip)
    add_hecbench(atan2 atan2-hip)
    add_hecbench(atomicAggregate atomicAggregate-hip)
    add_hecbench(atomicCAS atomicCAS-hip)
    add_hecbench(atomicCost atomicCost-hip)
    add_hecbench(atomicIntrinsics atomicIntrinsics-hip)
    add_hecbench(atomicPerf atomicPerf-hip)
    add_hecbench(atomicReduction atomicReduction-hip)
    add_hecbench(atomicSystemWide atomicSystemWide-hip)
    add_hecbench(attention attention-hip)
    add_hecbench(attentionMultiHead attentionMultiHead-hip)
    add_hecbench(axhelm axhelm-hip)
    add_hecbench(babelstream babelstream-hip)
    add_hecbench(background-subtract background-subtract-hip)
    add_hecbench(backprop backprop-hip)
    add_hecbench(bezier-surface bezier-surface-hip)
    add_hecbench(bfs bfs-hip)
    add_hecbench(bh bh-hip)
    add_hecbench(bilateral bilateral-hip)
    add_hecbench(bincount bincount-hip)
    add_hecbench(binomial binomial-hip)
    add_hecbench(bitcracker bitcracker-hip)
    add_hecbench(bitonic-sort bitonic-sort-hip)
    add_hecbench(bitpacking bitpacking-hip)
    add_hecbench(black-scholes black-scholes-hip)
    add_hecbench(bm3d bm3d-hip)
    add_hecbench(bmf bmf-hip)
    add_hecbench(bn bn-hip)
    add_hecbench(bonds bonds-hip)
    add_hecbench(boxfilter boxfilter-hip)
    add_hecbench(bscan bscan-hip)
    add_hecbench(bsearch bsearch-hip)
    add_hecbench(bspline-vgh bspline-vgh-hip)
    add_hecbench(bsw bsw-hip)
    add_hecbench(b+tree b+tree-hip)
    add_hecbench(btree btree-hip)
    add_hecbench(burger burger-hip)
    add_hecbench(bwt bwt-hip)
    add_hecbench(car car-hip)
    add_hecbench(cbsfil cbsfil-hip)
    add_hecbench(cc cc-hip)
    add_hecbench(ccsd-trpdrv ccsd-trpdrv-hip)
    add_hecbench(ccs ccs-hip)
    add_hecbench(ced ced-hip)
    add_hecbench(cfd cfd-hip)
    add_hecbench(chacha20 chacha20-hip)
    add_hecbench(channelShuffle channelShuffle-hip)
    add_hecbench(channelSum channelSum-hip)
    add_hecbench(che che-hip)
    add_hecbench(chemv chemv-hip)
    add_hecbench(chi2 chi2-hip)
    add_hecbench(clenergy clenergy-hip)
    add_hecbench(clink clink-hip)
    add_hecbench(clock clock-hip)
    add_hecbench(cm cm-hip)
    add_hecbench(cmembench cmembench-hip)
    add_hecbench(cmp cmp-hip)
    add_hecbench(cobahh cobahh-hip)
    add_hecbench(collision collision-hip)
    add_hecbench(colorwheel colorwheel-hip)
    add_hecbench(columnarSolver columnarSolver-hip)
    add_hecbench(complex complex-hip)
    add_hecbench(compute-score compute-score-hip)
    add_hecbench(concat concat-hip)
    add_hecbench(concurrentKernels concurrentKernels-hip)
    add_hecbench(contract contract-hip)
    add_hecbench(conversion conversion-hip)
    add_hecbench(convolution1D convolution1D-hip)
    add_hecbench(convolutionSeparable convolutionSeparable-hip)
    add_hecbench(cooling cooling-hip)
    add_hecbench(coordinates coordinates-hip)
    add_hecbench(copy copy-hip)
    add_hecbench(crc64 crc64-hip)
    add_hecbench(crs crs-hip)
    add_hecbench(cross cross-hip)
    add_hecbench(crossEntropy crossEntropy-hip)
    add_hecbench(d2q9-bgk d2q9-bgk-hip)
    add_hecbench(d3q19-bgk d3q19-bgk-hip)
    add_hecbench(damage damage-hip)
    add_hecbench(daphne daphne-hip)
    add_hecbench(dct8x8 dct8x8-hip)
    add_hecbench(ddbp ddbp-hip)
    add_hecbench(debayer debayer-hip)
    add_hecbench(degrid degrid-hip)
    add_hecbench(dense-embedding dense-embedding-hip)
    add_hecbench(depiction depiction-hip)
    add_hecbench(depixel depixel-hip)
    add_hecbench(determinant determinant-hip)
    add_hecbench(diamond diamond-hip)
    add_hecbench(dispatch dispatch-hip)
    add_hecbench(distort distort-hip)
    add_hecbench(divergence divergence-hip)
    add_hecbench(doh doh-hip)
    add_hecbench(dp dp-hip)
    add_hecbench(dpid dpid-hip)
    add_hecbench(dropout dropout-hip)
    add_hecbench(dslash dslash-hip)
    add_hecbench(dwconv dwconv-hip)
    add_hecbench(dxtc1 dxtc1-hip)
    add_hecbench(easyWave easyWave-hip)
    add_hecbench(ecdh ecdh-hip)
    add_hecbench(egs egs-hip)
    add_hecbench(eigenvalue eigenvalue-hip)
    add_hecbench(eikonal eikonal-hip)
    add_hecbench(entropy entropy-hip)
    add_hecbench(epistasis epistasis-hip)
    add_hecbench(ert ert-hip)
    add_hecbench(expdist expdist-hip)
    add_hecbench(extend2 extend2-hip)
    add_hecbench(extrema extrema-hip)
    add_hecbench(f16max f16max-hip)
    add_hecbench(f16sp f16sp-hip)
    add_hecbench(face face-hip)
    add_hecbench(fdtd3d fdtd3d-hip)
    add_hecbench(feynman-kac feynman-kac-hip)
    add_hecbench(fft fft-hip)
    add_hecbench(fhd fhd-hip)
    add_hecbench(filter filter-hip)
    add_hecbench(flame flame-hip)
    add_hecbench(flip flip-hip)
    add_hecbench(floydwarshall floydwarshall-hip)
    add_hecbench(fluidSim fluidSim-hip)
    add_hecbench(fpc fpc-hip)
    add_hecbench(fpdc fpdc-hip)
    add_hecbench(frechet frechet-hip)
    add_hecbench(fresnel fresnel-hip)
    add_hecbench(frna frna-hip)
    add_hecbench(fsm fsm-hip)
    add_hecbench(fwt fwt-hip)
    add_hecbench(gabor gabor-hip)
    add_hecbench(gaussian gaussian-hip)
    add_hecbench(gc gc-hip)
    add_hecbench(gd gd-hip)
    add_hecbench(ge-spmm ge-spmm-hip)
    add_hecbench(gem gem-hip)
    add_hecbench(gemmEx gemmEx-hip)
    add_hecbench(geodesic geodesic-hip)
    add_hecbench(gibbs gibbs-hip)
    add_hecbench(glu glu-hip)
    add_hecbench(gmm gmm-hip)
    add_hecbench(goulash goulash-hip)
    add_hecbench(gpp gpp-hip)
    add_hecbench(greens greens-hip)
    add_hecbench(grep grep-hip)
    add_hecbench(grrt grrt-hip)
    add_hecbench(gru gru-hip)
    add_hecbench(heat2d heat2d-hip)
    add_hecbench(heat heat-hip)
    add_hecbench(heartwall heartwall-hip)
    add_hecbench(hellinger hellinger-hip)
    add_hecbench(histo histo-hip)
    add_hecbench(histogram histogram-hip)
    add_hecbench(hmm hmm-hip)
    add_hecbench(hogbom hogbom-hip)
    add_hecbench(hotspot3D hotspot3D-hip)
    add_hecbench(hotspot hotspot-hip)
    add_hecbench(hpcg hpcg-hip)
    add_hecbench(hunger hunger-hip)
    add_hecbench(hungarian hungarian-hip)
    add_hecbench(hwt1d hwt1d-hip)
    add_hecbench(hybridsort hybridsort-hip)
    add_hecbench(hypterm hypterm-hip)
    add_hecbench(idivide idivide-hip)
    add_hecbench(is is-hip)
    add_hecbench(ising ising-hip)
    add_hecbench(iso2dfd iso2dfd-hip)
    add_hecbench(jaccard jaccard-hip)
    add_hecbench(jacobi jacobi-hip)
    add_hecbench(jenkins-hash jenkins-hash-hip)
    add_hecbench(julian julian-hip)
    add_hecbench(kalman kalman-hip)
    add_hecbench(keccaktreehash keccaktreehash-hip)
    add_hecbench(keogh keogh-hip)
    add_hecbench(kmeans kmeans-hip)
    add_hecbench(knn knn-hip)
    add_hecbench(lanczos lanczos-hip)
    add_hecbench(laplace3d laplace3d-hip)
    add_hecbench(laplace laplace-hip)
    add_hecbench(lavaMD lavaMD-hip)
    add_hecbench(layout layout-hip)
    add_hecbench(lci lci-hip)
    add_hecbench(lda lda-hip)
    add_hecbench(ldpc ldpc-hip)
    add_hecbench(lebesgue lebesgue-hip)
    add_hecbench(leukocyte leukocyte-hip)
    add_hecbench(lf lf-hip)
    add_hecbench(lf-log lf-log-hip)
    add_hecbench(lfss lfss-hip)
    add_hecbench(libor libor-hip)
    add_hecbench(lid-driven-cavity lid-driven-cavity-hip)
    add_hecbench(linearprobing linearprobing-hip)
    add_hecbench(logan logan-hip)
    add_hecbench(logprob logprob-hip)
    add_hecbench(lombscargle lombscargle-hip)
    add_hecbench(loopback loopback-hip)
    add_hecbench(ls ls-hip)
    add_hecbench(lrn lrn-hip)
    add_hecbench(lsqr lsqr-hip)
    add_hecbench(lsqm lsqm-hip)
    add_hecbench(lsqt lsqt-hip)
    add_hecbench(lu lu-hip)
    add_hecbench(lulesh lulesh-hip)
    add_hecbench(mallocFree mallocFree-hip)
    add_hecbench(mandelbrot mandelbrot-hip)
    add_hecbench(mask mask-hip)
    add_hecbench(match match-hip)
    add_hecbench(matmul matmul-hip)
    add_hecbench(mav mav-hip)
    add_hecbench(mbmb mbmb-hip)
    add_hecbench(mbmf mbmf-hip)
    add_hecbench(mchd mchd-hip)
    add_hecbench(mdl mdl-hip)
    add_hecbench(meanshift meanshift-hip)
    add_hecbench(medianfilter medianfilter-hip)
    add_hecbench(memcpy memcpy-hip)
    add_hecbench(mgmt mgmt-hip)
    add_hecbench(mgrd mgrd-hip)
    add_hecbench(midp midp-hip)
    add_hecbench(minimap2 minimap2-hip)
    add_hecbench(minkowski minkowski-hip)
    add_hecbench(mkhl mkhl-hip)
    add_hecbench(mkl mkl-hip)
    add_hecbench(mkl-sgemm mkl-sgemm-hip)
    add_hecbench(mlb mlb-hip)
    add_hecbench(mmg mgm-hip)
    add_hecbench(mmod mmod-hip)
    add_hecbench(modi modi-hip)
    add_hecbench(moj moj-hip)
    add_hecbench(moj6 moj6-hip)
    add_hecbench(mpi mpi-hip)
    add_hecbench(mpt mpt-hip)
    add_hecbench(mqa mqa-hip)
    add_hecbench(mrb mrb-hip)
    add_hecbench(mrb2 mrb2-hip)
    add_hecbench(mri mri-hip)
    add_hecbench(mri5 mri5-hip)
    add_hecbench(mrr mrr-hip)
    add_hecbench(mrs mrs-hip)
    add_hecbench(mrt mrt-hip)
    add_hecbench(msa msa-hip)
    add_hecbench(msb msb-hip)
    add_hecbench(msl msl-hip)
    add_hecbench(msls msls-hip)
    add_hecbench(mtd mtd-hip)
    add_hecbench(mtf mtf-hip)
    add_hecbench(mtk mtk-hip)
    add_hecbench(mtr mtr-hip)
    add_hecbench(mvd mvd-hip)
    add_hecbench(mvs mvs-hip)
    add_hecbench(myh myh-hip)
    add_hecbench(myj myj-hip)
    add_hecbench(nam nam-hip)
    add_hecbench(nbc nbc-hip)
    add_hecbench(nbd nbd-hip)
    add_hecbench(ncd ncd-hip)
    add_hecbench(nck nck-hip)
    add_hecbench(ncm ncm-hip)
    add_hecbench(ncs ncs-hip)
    add_hecbench(ncv ncv-hip)
    add_hecbench(ncw ncw-hip)
    add_hecbench(ndc ndc-hip)
    add_hecbench(nex nex-hip)
    add_hecbench(nex2 nex2-hip)
    add_hecbench(nfe nfe-hip)
    add_hecbench(nff nff-hip)
    add_hecbench(nfw nfw-hip)
    add_hecbench(nif nif-hip)
    add_hecbench(nip nip-hip)
    add_hecbench(nis nis-hip)
    add_hecbench(njc njc-hip)
    add_hecbench(njcb njcb-hip)
    add_hecbench(njl njl-hip)
    add_hecbench(njms njms-hip)
    add_hecbench(njmx njmx-hip)
    add_hecbench(nmp nmp-hip)
    add_hecbench(nmr nmr-hip)
    add_hecbench(nms nms-hip)
    add_hecbench(nn nn-hip)
    add_hecbench(noh noh-hip)
    add_hecbench(nok nok-hip)
    add_hecbench(nonzero nonzero-hip)
    add_hecbench(nord nord-hip)
    add_hecbench(norm2 norm2-hip)
    add_hecbench(nrm nrm-hip)
    add_hecbench(nsx nsx-hip)
    add_hecbench(ntt ntt-hip)
    add_hecbench(ntw ntw-hip)
    add_hecbench(nw nw-hip)
    add_hecbench(obc obc-hip)
    add_hecbench(obs obs-hip)
    add_hecbench(ofc ofc-hip)
    add_hecbench(ofe ofe-hip)
    add_hecbench(ofm ofm-hip)
    add_hecbench(oks oks-hip)
    add_hecbench(onr onr-hip)
    add_hecbench(orc orc-hip)
    add_hecbench(orh orh-hip)
    add_hecbench(osr osr-hip)
    add_hecbench(p2p p2p-hip)
    add_hecbench(p4 p4-hip)
    add_hecbench(pad pad-hip)
    add_hecbench(page-rank page-rank-hip)
    add_hecbench(particle-diffusion particle-diffusion-hip)
    add_hecbench(particlefilter particlefilter-hip)
    add_hecbench(particles particles-hip)
    add_hecbench(pathfinder pathfinder-hip)
    add_hecbench(pcc pcc-hip)
    add_hecbench(perlin perlin-hip)
    add_hecbench(permutate permutate-hip)
    add_hecbench(perplexity perplexity-hip)
    add_hecbench(phmm phmm-hip)
    add_hecbench(pitch pitch-hip)
    add_hecbench(pnpoly pnpoly-hip)
    add_hecbench(pns pns-hip)
    add_hecbench(pointwise pointwise-hip)
    add_hecbench(popcount popcount-hip)
    add_hecbench(prefetch prefetch-hip)
    add_hecbench(present present-hip)
    add_hecbench(prna prna-hip)
    add_hecbench(projectile projectile-hip)
    add_hecbench(pso pso-hip)
    add_hecbench(quicksort quicksort-hip)
    add_hecbench(radixsort radixsort-hip)
    add_hecbench(radixsort2 radixsort2-hip)
    add_hecbench(rainflow rainflow-hip)
    add_hecbench(randomAccess randomAccess-hip)
    add_hecbench(reaction reaction-hip)
    add_hecbench(recursiveGaussian recursiveGaussian-hip)
    add_hecbench(relu relu-hip)
    add_hecbench(remap remap-hip)
    add_hecbench(resize resize-hip)
    add_hecbench(resnet-kernels resnet-kernels-hip)
    add_hecbench(reverse reverse-hip)
    add_hecbench(rfs rfs-hip)
    add_hecbench(ring ring-hip)
    add_hecbench(rng-wallace rng-wallace-hip)
    add_hecbench(rodrigues rodrigues-hip)
    add_hecbench(rowwiseMoments rowwiseMoments-hip)
    add_hecbench(rsbench rsbench-hip)
    add_hecbench(rsc rsc-hip)
    add_hecbench(rsmt rsmt-hip)
    add_hecbench(rtm8 rtm8-hip)
    add_hecbench(rushlarsen rushlarsen-hip)
    add_hecbench(sa sa-hip)
    add_hecbench(sad sad-hip)
    add_hecbench(sampling sampling-hip)
    add_hecbench(saxpy-ompt saxpy-ompt-hip)
    add_hecbench(scan scan-hip)
    add_hecbench(scan2 scan2-hip)
    add_hecbench(scan3 scan3-hip)
    add_hecbench(sc sc-hip)
    add_hecbench(scel scel-hip)
    add_hecbench(score score-hip)
    add_hecbench(seam-carving seam-carving-hip)
    add_hecbench(secp256k1 secp256k1-hip)
    add_hecbench(segment-reduce segment-reduce-hip)
    add_hecbench(segsort segsort-hip)
    add_hecbench(sheath sheath-hip)
    add_hecbench(shmembench shmembench-hip)
    add_hecbench(shuffle shuffle-hip)
    add_hecbench(si si-hip)
    add_hecbench(simplemoc simplemoc-hip)
    add_hecbench(simpleMultiDevice simpleMultiDevice-hip)
    add_hecbench(simpleSpmv simpleSpmv-hip)
    add_hecbench(snake snake-hip)
    add_hecbench(sobel sobel-hip)
    add_hecbench(sobol sobol-hip)
    add_hecbench(softmax softmax-hip)
    add_hecbench(sort sort-hip)
    add_hecbench(sortKV sortKV-hip)
    add_hecbench(sosfil sosfil-hip)
    add_hecbench(sparkler sparkler-hip)
    add_hecbench(sph sph-hip)
    add_hecbench(split split-hip)
    add_hecbench(spm spm-hip)
    add_hecbench(sptrsv sptrsv-hip)
    add_hecbench(ss ss-hip)
    add_hecbench(ssp ssp-hip)
    add_hecbench(stddev stddev-hip)
    add_hecbench(stencil1d stencil1d-hip)
    add_hecbench(stencil3d stencil3d-hip)
    add_hecbench(streamcluster streamcluster-hip)
    add_hecbench(stsg stsg-hip)
    add_hecbench(su3 su3-hip)
    add_hecbench(surfel surfel-hip)
    add_hecbench(svd3x3 svd3x3-hip)
    add_hecbench(sw4ck sw4ck-hip)
    add_hecbench(swish swish-hip)
    add_hecbench(tc tc-hip)
    add_hecbench(tensorAccessor tensorAccessor-hip)
    add_hecbench(tensorT tensorT-hip)
    add_hecbench(testSNAP testSNAP-hip)
    add_hecbench(thomas thomas-hip)
    add_hecbench(threadfence threadfence-hip)
    add_hecbench(tissue tissue-hip)
    add_hecbench(tonemapping tonemapping-hip)
    add_hecbench(tpacf tpacf-hip)
    add_hecbench(tqs tqs-hip)
    add_hecbench(triad triad-hip)
    add_hecbench(tridiagonal tridiagonal-hip)
    add_hecbench(tsa tsa-hip)
    add_hecbench(tsp tsp-hip)
    add_hecbench(unfold unfold-hip)
    add_hecbench(urng urng-hip)
    add_hecbench(vanGenuchten vanGenuchten-hip)
    add_hecbench(vmc vmc-hip)
    add_hecbench(vol2col vol2col-hip)
    add_hecbench(vote vote-hip)
    add_hecbench(voxelizer voxelizer-hip)
    add_hecbench(warpselect warpselect-hip)
    add_hecbench(warpsort warpsort-hip)
    add_hecbench(wedford wedford-hip)
    add_hecbench(winograd winograd-hip)
    add_hecbench(wlcpow wlcpow-hip)
    add_hecbench(word2vec word2vec_hip)
    add_hecbench(wordcount wordcount-hip)
    add_hecbench(wsm5 wsm5-hip)
    add_hecbench(wyllie wyllie-hip)
    add_hecbench(xlqc xlqc-hip)
    add_hecbench(xsbench xsbench-hip)
    add_hecbench(zerocopy zerocopy-hip)
    add_hecbench(zeropoint zeropoint-hip)
    add_hecbench(zmddft zmddft-hip)
    add_hecbench(zoom zoom-hip)
endif()
